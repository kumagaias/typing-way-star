# 実装計画

- [ ] 1. プロジェクト基盤とインフラ構築
  - プロジェクトディレクトリ構造を作成し、Dev Containers環境を設定する
  - Terraformでマルチアカウント AWS インフラを構築する（DynamoDB、Lambda、API Gateway、S3、CloudFront）
  - GitHub Actions CI/CDパイプラインをOIDC認証で設定する
  - _要件: 9.5, 9.6, 8.2, 8.3_

- [ ] 2. データベース設計と初期データ作成
- [ ] 2.1 DynamoDBテーブル作成とスキーマ定義
  - wordsテーブル、translationsテーブル、user_progressテーブル、scoresテーブルを作成する
  - GSI（Global Secondary Index）を適切に設定する
  - テーブル作成用Terraformコードを実装する
  - _要件: 10.3_

- [ ] 2.2 初期データ生成スクリプト実装
  - 日本語問題生成スクリプト（600問：単語/会話×easy/medium/hard各100個）を作成する
  - AWS Translate APIを使用した英語翻訳スクリプトを実装する
  - DynamoDB一括インポートスクリプトを作成する
  - データ品質検証スクリプトを実装する
  - _要件: 10.1, 10.2, 10.4_

- [ ] 3. バックエンドAPI基盤構築
- [ ] 3.1 Go Lambda関数の基本構造実装
  - Gin フレームワークを使用したLambda関数のベースコードを作成する
  - DynamoDB接続とエラーハンドリングの共通ライブラリを実装する
  - 入力検証とセキュリティ対策の共通ミドルウェアを作成する
  - _要件: 8.4, 8.5_

- [ ] 3.2 問題取得API実装
  - GET /api/problems エンドポイントを実装する
  - モード・難易度・翻訳方向に基づく問題フィルタリング機能を作成する
  - DynamoDB GSIを使用した効率的なクエリを実装する
  - API単体テストを作成する
  - _要件: 5.1, 5.6_

- [ ] 3.3 スコア管理API実装
  - POST /api/scores エンドポイントを実装する
  - スコア改ざん防止とゲームセッション整合性チェックを実装する
  - ユーザー進捗管理（ステージ解放・リトライ回数）機能を作成する
  - 失敗時のスコアロールバック機能を実装する
  - API単体テストを作成する
  - _要件: 6.1, 6.4, 6.5, 8.3_

- [ ] 3.4 ランキングAPI実装
  - GET /api/rankings エンドポイントを実装する
  - ステージ別・モード×難易度別・翻訳方向別フィルタリングを実装する
  - DynamoDB GSIを使用した効率的なランキングクエリを作成する
  - ユーザー自身の順位表示機能を実装する
  - API単体テストを作成する
  - _要件: 6.3, 6.6_

- [ ] 4. フロントエンド基盤構築
- [ ] 4.1 Next.js プロジェクト初期設定
  - Next.js、TypeScript、Tailwind CSSの基本設定を行う
  - Three.jsとWebGL環境の初期設定を実装する
  - APIクライアントとエラーハンドリングの共通ライブラリを作成する
  - _要件: 7.4, 7.5_

- [ ] 4.2 ゲーム状態管理システム実装
  - ゲーム状態（現在ステージ、スコア、コンボ等）の管理クラスを作成する
  - ユーザー進捗（解放ステージ、完了ステージ）の管理機能を実装する
  - ローカルストレージを使用した状態永続化を実装する
  - 状態管理の単体テストを作成する
  - _要件: 2.1, 2.5_

- [ ] 5. 3Dゲームエンジン実装
- [ ] 5.1 基本3D描画システム構築
  - Three.jsを使用した基本的な3Dシーンを作成する
  - カメラ、ライティング、レンダラーの初期設定を実装する
  - 60FPS維持のためのパフォーマンス最適化を実装する
  - WebGL 2.0対応とブラウザ互換性チェックを実装する
  - _要件: 7.1, 7.2, 7.5_

- [ ] 5.2 車両システム実装
  - 3種類の車両（スピード、バランス、スタミナ）の3Dモデルを作成する
  - 車両の性能特性（基本速度、減速率）を実装する
  - 車両選択UIと3Dプレビュー機能を作成する
  - 車両の動作（加速・減速）アニメーションを実装する
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5_

- [ ] 5.3 環境レンダリングシステム実装
  - 8ステージの環境（海岸、砂漠、山道、市街地）の3Dモデルを作成する
  - 時間帯別照明システム（昼、夕方、夜）を実装する
  - 環境エフェクト（波音、砂塵、霧、交通）を追加する
  - 3Dパースペクティブ道路ビューと背景スクロールを実装する
  - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 6. 翻訳タイピングシステム実装
- [ ] 6.1 翻訳問題表示システム構築
  - 翻訳問題の表示UIコンポーネントを作成する
  - ソース言語とターゲット言語の切り替え機能を実装する
  - 問題の難易度とモード（単語・会話）表示を実装する
  - 制限時間表示とカウントダウン機能を作成する
  - _要件: 5.1_

- [ ] 6.2 リアルタイム翻訳評価システム実装
  - ユーザー入力のリアルタイム翻訳精度評価（0-100%）を実装する
  - 正解・代替表現・類義語との照合アルゴリズムを作成する
  - 部分一致・完全一致の精度計算ロジックを実装する
  - 翻訳精度に基づく車両速度制御を実装する
  - _要件: 5.2, 5.3, 5.4_

- [ ] 6.3 ヒントシステム実装
  - 難しい問題での代替表現・類義語ヒント表示を実装する
  - ヒント表示タイミングの制御機能を作成する
  - ヒント使用時のスコア調整機能を実装する
  - _要件: 5.6_

- [ ] 6.4 コンボシステム実装
  - 連続正解カウンターとコンボボーナス計算を実装する
  - コンボ表示UIとエフェクトを作成する
  - コンボ切断時の処理を実装する
  - _要件: 5.5_

- [ ] 7. ゲーム進行システム実装
- [ ] 7.1 ルートマップシステム構築
  - 8ステージが繋がったルートマップUIを作成する
  - ステージ状態表示（解放済み、現在位置、未解放、クリア済み）を実装する
  - ステージクリア時の進行アニメーションを作成する
  - プレイヤー位置アイコンの移動演出を実装する
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 7.2 ステージ進行管理実装
  - ステージ解放・完了状態の管理機能を作成する
  - 前ステージクリア条件チェックを実装する
  - ステージ失敗時の処理（リトライ、スコアロールバック）を実装する
  - 全8ステージクリア時の特別演出を作成する
  - _要件: 2.5, 2.6_

- [ ] 8. スコアシステム実装
- [ ] 8.1 スコア計算システム構築
  - 基本スコア計算（難易度×速度×コンボ×完走ボーナス）を実装する
  - WPM、正答率、完走時間、最高コンボの計算機能を作成する
  - タイムボーナスと完走ボーナスの計算を実装する
  - _要件: 6.1, 6.2_

- [ ] 8.2 記録管理システム実装
  - ステージ別・モード別・難易度別記録管理を実装する
  - ベストスコア・ベストタイム記録の更新機能を作成する
  - 挑戦前スコア保存と失敗時ロールバック機能を実装する
  - _要件: 6.4, 6.5_

- [ ] 9. ランキングシステム実装
- [ ] 9.1 ランキング表示システム構築
  - ステージ別・モード×難易度別・翻訳方向別フィルタリングUIを作成する
  - TOP50ランキング表示とユーザー自身の記録ハイライトを実装する
  - 月間ランキングと全期間ランキングの切り替え機能を作成する
  - _要件: 6.3, 6.6_

- [ ] 9.2 ランキングデータ管理実装
  - リアルタイムランキング更新機能を実装する
  - ランキングキャッシュとパフォーマンス最適化を実装する
  - ランキング不正防止機能を作成する
  - _要件: 6.6_

- [ ] 10. UI/UX実装
- [ ] 10.1 メイン画面UI実装
  - 言語・難易度・モード選択画面を作成する
  - 車両選択画面と性能比較表示を実装する
  - 設定画面とオプション管理を作成する
  - _要件: 1.1, 1.2, 1.3_

- [ ] 10.2 ゲーム画面UI実装
  - ゲーム中のHUD（スピードメーター、距離表示、燃料ゲージ）を作成する
  - スコア・コンボ表示とリアルタイム更新を実装する
  - 翻訳精度表示とビジュアルフィードバックを作成する
  - _要件: 5.2_

- [ ] 10.3 結果画面UI実装
  - ステージクリア画面と詳細統計表示を作成する
  - 学習ポイント（間違えた問題の正解例）表示を実装する
  - 全ステージクリア画面と特別演出を作成する
  - _要件: 2.6_

- [ ] 11. 統合テストと品質保証
- [ ] 11.1 E2Eテスト実装
  - Playwrightを使用した完全ゲームフローのE2Eテストを作成する
  - 各ステージクリアまでの自動テストを実装する
  - 異なるブラウザでの互換性テストを作成する
  - _要件: 7.4, 9.2_

- [ ] 11.2 パフォーマンステスト実装
  - 60FPS維持のパフォーマンステストを作成する
  - API応答時間（200ms以下）のテストを実装する
  - 初期ロード時間（5秒以下）のテストを作成する
  - _要件: 7.1, 7.2, 7.3_

- [ ] 11.3 セキュリティテスト実装
  - XSS、CSRF、クリックジャッキング対策のテストを作成する
  - スコア改ざん防止機能のテストを実装する
  - 入力検証とサニタイゼーションのテストを作成する
  - _要件: 8.3, 8.4, 8.5_

- [ ] 12. デプロイメントと運用準備
- [ ] 12.1 本番環境デプロイ
  - 本番アカウント（typing-way-star-production）へのデプロイを実行する
  - ドメイン設定（typing-way-star.kumarabo.com）とSSL証明書を設定する
  - AWS WAF設定とセキュリティ対策を適用する
  - _要件: 8.2, 8.6_

- [ ] 12.2 監視とアラート設定
  - AWS CloudWatchでのコスト監視とアラート設定を実装する
  - パフォーマンス監視とエラー追跡を設定する
  - ログ管理と分析環境を構築する
  - _要件: 8.6_

- [ ] 12.3 運用ドキュメント作成
  - README.mdの更新と環境構築手順の文書化を行う
  - API仕様書（OpenAPI）の完成と公開を実施する
  - 運用・保守手順書を作成する
  - _要件: 9.6_